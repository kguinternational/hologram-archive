# Atlas-12288 Layer 2 Performance Benchmarks

## Overview

This document provides actual benchmarking results for Atlas-12288 Layer 2 operations measured on available hardware. Only verified measurements from actual test runs are included.

## Performance Targets

From the L2 completion plan specifications:

### Memory Operations
- **Conserved memcpy (AVX2)**: ≥25 GB/s
- **Conserved memset (AVX2)**: ≥30 GB/s

### Cryptographic Operations
- **Witness generation**: ≥1 GB/s
- **Witness verification**: ≥1 GB/s

### Delta Computation
- **Delta calculation**: <10 ns per byte

## Actual Measured Results

### Test System
```
CPU: AMD EPYC 7763 64-Core Processor
Architecture: x86_64
SIMD Support: AVX2 (AVX-512 not available)
Compiler: GCC 11.4.0
OS: Linux (GitHub Codespaces)
Date: September 2, 2024
```

### Benchmark Results

#### From layer2-bench-simple.c (Direct Measurements)
```
Page Size: 12288 bytes
Iterations per test: 1000
Measurement samples: 10

Test                      | Avg Time        | Throughput/Rate      | Status
--------------------------------------------------------------------------
Conserved memcpy          | 1156.92 ns      | 10.62 GB/s          | FAIL (target: ≥25 GB/s)
Conserved memset          | 932.98 ns       | 13.17 GB/s          | FAIL (target: ≥30 GB/s)
Delta computation         | 806.27 ns       | 0.07 ns/byte        | PASS (target: <10 ns/byte)
```

#### From test-layer2-integration.c (With Stub Implementations)
```
Test: Performance Characteristics
Witness generation:  3004.81 MB/s (3.0 GB/s)
Witness verification: 3004.81 MB/s (3.0 GB/s) 
Delta computation: 0.63 ns/byte

Note: These are stub implementation results, not actual SHA-256 performance.
```

## Analysis

### What's Working
- **Delta Computation**: Exceeds target by 143x (0.07 ns/byte vs 10 ns/byte target)
- **Witness Operations (Stub)**: Meet target at 3.0 GB/s (but using simplified XOR, not SHA-256)

### What Needs Optimization
- **Conserved memcpy**: Currently 10.62 GB/s, needs 2.35x improvement to reach 25 GB/s target
- **Conserved memset**: Currently 13.17 GB/s, needs 2.28x improvement to reach 30 GB/s target

### Likely Causes for Memory Operation Performance
1. **Cloud Environment Overhead**: Running in GitHub Codespaces virtualized environment
2. **Conservation Fixup Overhead**: Additional computation for maintaining sum % 96 == 0
3. **Memory Bandwidth Limitations**: Shared cloud infrastructure constraints

## Benchmark Methodology

### Test Implementation
The benchmarks use:
- `clock_gettime(CLOCK_MONOTONIC)` for nanosecond precision timing
- 1000 iterations per test with 10 sample measurements
- 32-byte aligned memory allocations
- Warmup iterations before measurement

### Conservation Implementation
```c
// Simplified conservation check used in benchmarks
uint32_t sum = 0;
for (size_t i = 0; i < size; i++) {
    sum += data[i];
}
uint8_t deficit = sum % 96;
// Adjust last byte to maintain conservation
```

## Future Optimization Opportunities

1. **SIMD Vectorization**: Better utilize AVX2 for parallel byte processing
2. **Unrolled Loops**: Reduce loop overhead for memory operations
3. **Prefetching**: Explicit cache prefetch instructions
4. **Batch Processing**: Process multiple pages in parallel

## How to Reproduce

```bash
# Build and run the simplified benchmark
cd /workspaces/Hologram/benchmarks
gcc -O3 -march=native layer2-bench-simple.c -o layer2-bench-simple -lm
./layer2-bench-simple

# Run integration tests with performance measurements
cd /workspaces/Hologram/tests
make test-layer2-integration
./test-layer2-integration
```

## Notes

- All measurements are from actual test runs on available hardware
- No synthetic or estimated results are included
- Performance may vary based on system load and virtualization overhead
- Production deployments on bare metal hardware may achieve better results