<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Chapter 3: Intrinsic Labels, Schedules, and Receipts - The Hologram (12,288): A Complete Computer Science Formalization</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="A comprehensive computer science formalization of the 12,288 Hologram model of computation using mainstream CS formalisms">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/custom.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../title-page.html">Title Page</a></li><li class="chapter-item expanded affix "><a href="../preface.html">Preface</a></li><li class="chapter-item expanded affix "><a href="../readers-guide.html">Reader's Guide & Conventions</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Part I: Mathematical Foundations</li><li class="chapter-item expanded "><a href="../part-1/01-information-as-lawful-structure.html"><strong aria-hidden="true">1.</strong> Chapter 1: Information as Lawful Structure</a></li><li class="chapter-item expanded "><a href="../part-1/02-universal-automaton.html"><strong aria-hidden="true">2.</strong> Chapter 2: The Universal Automaton</a></li><li class="chapter-item expanded "><a href="../part-1/03-labels-schedules-receipts.html" class="active"><strong aria-hidden="true">3.</strong> Chapter 3: Intrinsic Labels, Schedules, and Receipts</a></li><li class="chapter-item expanded "><a href="../part-1/04-content-addressable-memory.html"><strong aria-hidden="true">4.</strong> Chapter 4: Content-Addressable Memory</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Part II: Algebraic Structure</li><li class="chapter-item expanded "><a href="../part-2/05-lawfulness-as-type-system.html"><strong aria-hidden="true">5.</strong> Chapter 5: Lawfulness as a Type System</a></li><li class="chapter-item expanded "><a href="../part-2/06-programs-as-geometry.html"><strong aria-hidden="true">6.</strong> Chapter 6: Programs as Geometry</a></li><li class="chapter-item expanded "><a href="../part-2/07-algorithmic-reification.html"><strong aria-hidden="true">7.</strong> Chapter 7: Algorithmic Reification</a></li><li class="chapter-item expanded "><a href="../part-2/08-universal-cost.html"><strong aria-hidden="true">8.</strong> Chapter 8: The Universal Cost</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Part III: System Architecture</li><li class="chapter-item expanded "><a href="../part-3/09-security-safety-correctness.html"><strong aria-hidden="true">9.</strong> Chapter 9: Security, Safety, and Correctness</a></li><li class="chapter-item expanded "><a href="../part-3/10-worked-micro-examples.html"><strong aria-hidden="true">10.</strong> Chapter 10: Worked Micro-Examples</a></li><li class="chapter-item expanded "><a href="../part-3/11-interfaces-to-mainstream-cs.html"><strong aria-hidden="true">11.</strong> Chapter 11: Interfaces to Mainstream CS</a></li><li class="chapter-item expanded "><a href="../part-3/12-minimal-core.html"><strong aria-hidden="true">12.</strong> Chapter 12: Minimal Core</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Part IV: Protocol Design</li><li class="chapter-item expanded "><a href="../part-4/13-meta-theory-expressivity.html"><strong aria-hidden="true">13.</strong> Chapter 13: Meta-Theory & Expressivity</a></li><li class="chapter-item expanded "><a href="../part-4/14-normalization-confluence.html"><strong aria-hidden="true">14.</strong> Chapter 14: Normalization & Confluence</a></li><li class="chapter-item expanded "><a href="../part-4/15-categorical-semantics.html"><strong aria-hidden="true">15.</strong> Chapter 15: Categorical Semantics</a></li><li class="chapter-item expanded "><a href="../part-4/16-security-proofs.html"><strong aria-hidden="true">16.</strong> Chapter 16: Security Proofs</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Part V: Implementation</li><li class="chapter-item expanded "><a href="../part-5/17-optimization-landscape.html"><strong aria-hidden="true">17.</strong> Chapter 17: Optimization Landscape</a></li><li class="chapter-item expanded "><a href="../part-5/18-data-structure-implementation.html"><strong aria-hidden="true">18.</strong> Chapter 18: Data Structure Implementation</a></li><li class="chapter-item expanded "><a href="../part-5/19-runtime-architecture.html"><strong aria-hidden="true">19.</strong> Chapter 19: Runtime Architecture</a></li><li class="chapter-item expanded "><a href="../part-5/20-verification-system.html"><strong aria-hidden="true">20.</strong> Chapter 20: Verification System</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Part VI: Applications</li><li class="chapter-item expanded "><a href="../part-6/21-distributed-systems.html"><strong aria-hidden="true">21.</strong> Chapter 21: Distributed Systems</a></li><li class="chapter-item expanded "><a href="../part-6/22-database-systems.html"><strong aria-hidden="true">22.</strong> Chapter 22: Database Systems</a></li><li class="chapter-item expanded "><a href="../part-6/23-compiler-construction.html"><strong aria-hidden="true">23.</strong> Chapter 23: Compiler Construction</a></li><li class="chapter-item expanded "><a href="../part-6/24-machine-learning-integration.html"><strong aria-hidden="true">24.</strong> Chapter 24: Machine Learning Integration</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Appendices</li><li class="chapter-item expanded "><a href="../appendices/A-glossary.html"><strong aria-hidden="true">25.</strong> Appendix A: Glossary</a></li><li class="chapter-item expanded "><a href="../appendices/B-mathematical-notation.html"><strong aria-hidden="true">26.</strong> Appendix B: Mathematical Notation</a></li><li class="chapter-item expanded "><a href="../appendices/C-cs-mappings.html"><strong aria-hidden="true">27.</strong> Appendix C: Side-by-Side CS Mappings</a></li><li class="chapter-item expanded "><a href="../appendices/D-exercise-solutions.html"><strong aria-hidden="true">28.</strong> Appendix D: Exercise Solutions</a></li><li class="chapter-item expanded "><a href="../appendices/E-implementation-code.html"><strong aria-hidden="true">29.</strong> Appendix E: Implementation Code</a></li><li class="chapter-item expanded "><a href="../appendices/F-research-problems.html"><strong aria-hidden="true">30.</strong> Appendix F: Research Problems</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="../bibliography.html">Bibliography</a></li><li class="chapter-item expanded affix "><a href="../index.html">Index</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Hologram (12,288): A Complete Computer Science Formalization</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/uor-foundation/hologram-cs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="chapter-3-intrinsic-labels-schedules-and-receipts"><a class="header" href="#chapter-3-intrinsic-labels-schedules-and-receipts">Chapter 3: Intrinsic Labels, Schedules, and Receipts</a></h1>
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<p>Having established the 12,288 lattice as our computational space, we now need to give meaning to configurations on that space. In traditional computing, meaning comes from external interpretation—a bit pattern means what we say it means. In the Hologram model, meaning is intrinsic through three labeling systems:</p>
<ol>
<li><strong>R96 Resonance Classes</strong>: Semantic types as algebraic invariants</li>
<li><strong>C768 Cycle Structure</strong>: Fair scheduling built into physics</li>
<li><strong>Φ Lift/Projection</strong>: Information preservation under transformation</li>
</ol>
<p>These aren’t separate systems bolted together—they’re three aspects of a unified labeling scheme that makes lawfulness decidable and cheap to verify.</p>
<h2 id="resonance-classes-r96"><a class="header" href="#resonance-classes-r96">Resonance Classes (R96)</a></h2>
<h3 id="the-residue-system"><a class="header" href="#the-residue-system">The Residue System</a></h3>
<p><strong>Definition 3.1 (Resonance Map)</strong>:</p>
<pre><code>R: Σ → ℤ₉₆
R(b) = h₁(b mod 96) ⊕ h₂(⌊b/96⌋) ⊕ h₃(b)
</code></pre>
<p>where h₁, h₂, h₃ are carefully chosen mixing functions ensuring:</p>
<ul>
<li>Uniform distribution across residue classes</li>
<li>Algebraic compositionality</li>
<li>Collision resistance on structured inputs</li>
</ul>
<p><strong>Theorem 3.1 (Residue Distribution)</strong>:
For random byte b, P(R(b) = k) = 1/96 for all k ∈ ℤ₉₆.</p>
<h3 id="compositional-semantics"><a class="header" href="#compositional-semantics">Compositional Semantics</a></h3>
<p>The magic of R96: residues compose algebraically.</p>
<p><strong>Definition 3.2 (Multiset Residue)</strong>:
For bytes b₁,…,bₙ:</p>
<pre><code>R({b₁,...,bₙ}) = ⊕ᵢ R(bᵢ) (multiset sum in ℤ₉₆)
</code></pre>
<p><strong>Property 3.1 (Permutation Invariance)</strong>:
R({b₁,…,bₙ}) = R({bπ(1),…,bπ(n)}) for any permutation π.</p>
<p>This means semantic meaning is independent of ordering—crucial for parallelism.</p>
<h3 id="the-r96-checksum"><a class="header" href="#the-r96-checksum">The R96 Checksum</a></h3>
<p><strong>Definition 3.3 (R96 Digest)</strong>:
For configuration s on region Ω ⊂ T:</p>
<pre><code>R96(s,Ω) = Hash(histogram(R(s(t)) for t ∈ Ω))
</code></pre>
<p>The histogram captures the distribution of residue classes, and the hash produces a fixed-size digest.</p>
<h3 id="cs-analogue"><a class="header" href="#cs-analogue">CS Analogue</a></h3>
<p>Think of R96 as:</p>
<ul>
<li>A <strong>semantic hash function</strong> that preserves algebraic structure</li>
<li>A <strong>type system</strong> where types are residue classes</li>
<li>An <strong>abstract interpretation</strong> that’s complete for certain invariants</li>
<li>A <strong>homomorphic fingerprint</strong> enabling computation on encrypted data</li>
</ul>
<h3 id="running-example-string-processing"><a class="header" href="#running-example-string-processing">Running Example: String Processing</a></h3>
<pre><code class="language-python">text = "HELLO WORLD"
bytes = [ord(c) for c in text]
# [72, 69, 76, 76, 79, 32, 87, 79, 82, 76, 68]

residues = [R(b) for b in bytes]
# [24, 21, 28, 28, 31, 32, 39, 31, 34, 28, 20]

r96_digest = compute_r96_digest(residues)
# Histogram: {20:1, 21:1, 24:1, 28:3, 31:2, 32:1, 34:1, 39:1}
# Digest: 0x7A3E... (deterministic hash of histogram)
</code></pre>
<p>Any transformation that preserves the histogram preserves semantic meaning.</p>
<h2 id="cycle-structure-c768"><a class="header" href="#cycle-structure-c768">Cycle Structure (C768)</a></h2>
<h3 id="the-universal-schedule"><a class="header" href="#the-universal-schedule">The Universal Schedule</a></h3>
<p><strong>Definition 3.4 (Schedule Automorphism)</strong>:</p>
<pre><code>σ: T → T with order 768
σ = σ₄₈ × σ₁₆ where:
  σ₄₈: ℤ/48 → ℤ/48, rotation by 1
  σ₁₆: ℤ/256 → ℤ/256, rotation by 16
  lcm(48,16) = 768
</code></pre>
<p>Every site gets exactly one “time slot” per 768-step cycle.</p>
<h3 id="fairness-invariants"><a class="header" href="#fairness-invariants">Fairness Invariants</a></h3>
<p><strong>Definition 3.5 (Fairness Metrics)</strong>:</p>
<pre><code>FairnessMetrics = {
    mean_activation: ℝ,        // Average activations per cycle
    variance_activation: ℝ,     // Spread of activations
    max_wait: ℕ,               // Longest wait between activations
    flow_balance: ℤ₉₆,         // Net flow around cycle
}
</code></pre>
<p><strong>Theorem 3.2 (Perfect Fairness)</strong>:
Under σ, every site is visited exactly once per 768 steps, giving:</p>
<ul>
<li>mean_activation = 1/768</li>
<li>variance_activation = 0 (perfect uniformity)</li>
<li>max_wait = 768</li>
</ul>
<h3 id="orbit-structure"><a class="header" href="#orbit-structure">Orbit Structure</a></h3>
<p>The schedule creates orbits—paths that sites follow under repeated application of σ:</p>
<pre><code>Orbit(t) = {t, σ(t), σ²(t), ..., σ⁷⁶⁷(t)}
</code></pre>
<p><strong>Property 3.2</strong>: Every orbit has exactly 768 elements (σ is a cyclic permutation).</p>
<h3 id="cs-interpretation"><a class="header" href="#cs-interpretation">CS Interpretation</a></h3>
<p>C768 is simultaneously:</p>
<ul>
<li>A <strong>round-robin scheduler</strong> with perfect fairness</li>
<li>A <strong>clock generator</strong> with guaranteed periodicity</li>
<li>A <strong>load balancer</strong> with zero overhead</li>
<li>A <strong>consensus mechanism</strong> with deterministic ordering</li>
</ul>
<h3 id="interaction-with-computation"><a class="header" href="#interaction-with-computation">Interaction with Computation</a></h3>
<p>Programs don’t fight the schedule—they surf it:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn execute_on_schedule(lattice: &amp;mut Lattice, start: Site) {
    let mut current = start;
    for step in 0..768 {
        // Process site at its scheduled time
        let value = lattice.get(current);
        let processed = process(value, step);
        lattice.set(current, processed);

        current = current.rotate_schedule();
    }
    // After 768 steps, we're back at start
}
<span class="boring">}</span></code></pre></pre>
<h2 id="the-Φ-operator"><a class="header" href="#the-Φ-operator">The Φ Operator</a></h2>
<h3 id="lift-and-projection"><a class="header" href="#lift-and-projection">Lift and Projection</a></h3>
<p><strong>Definition 3.6 (Φ Operator Pair)</strong>:</p>
<pre><code>lift_Φ: Σᴮ → Σᴵ    (boundary → interior)
proj_Φ: Σᴵ → Σᴮ    (interior → boundary)
</code></pre>
<p>where B ⊂ T is the boundary region and I ⊂ T is the interior.</p>
<h3 id="round-trip-property"><a class="header" href="#round-trip-property">Round-Trip Property</a></h3>
<p><strong>Theorem 3.3 (Φ Coherence)</strong>:
At budget β = 0:</p>
<pre><code>proj_Φ ∘ lift_Φ = id_B
</code></pre>
<p>At budget β &gt; 0:</p>
<pre><code>||proj_Φ ∘ lift_Φ(x) - x|| ≤ f(β)
</code></pre>
<p>where f is a known error bound function.</p>
<h3 id="information-theoretic-interpretation"><a class="header" href="#information-theoretic-interpretation">Information-Theoretic Interpretation</a></h3>
<p>Φ is an optimal encoder/decoder pair:</p>
<ul>
<li><strong>Lift</strong>: Embeds boundary data into interior with redundancy</li>
<li><strong>Projection</strong>: Extracts boundary from interior, error-correcting</li>
</ul>
<p>The budget β controls the compression/redundancy tradeoff.</p>
<h3 id="cs-analogue-1"><a class="header" href="#cs-analogue-1">CS Analogue</a></h3>
<p>Φ resembles:</p>
<ul>
<li><strong>Erasure codes</strong> in distributed storage</li>
<li><strong>Holographic encoding</strong> in quantum error correction</li>
<li><strong>Dimensionality reduction</strong> preserving essential features</li>
<li><strong>Adjoint functors</strong> in category theory (when β = 0)</li>
</ul>
<h3 id="implementation-sketch"><a class="header" href="#implementation-sketch">Implementation Sketch</a></h3>
<pre><code class="language-python">def lift_phi(boundary_data, budget):
    # Spread boundary data across interior with redundancy
    interior = np.zeros(INTERIOR_SIZE)

    for i, value in enumerate(boundary_data):
        # Each boundary byte influences multiple interior sites
        spread_pattern = generate_spread(i, budget)
        for site, weight in spread_pattern:
            interior[site] += weight * value

    return normalize(interior)

def proj_phi(interior_data, budget):
    # Extract boundary from interior via optimal estimation
    boundary = np.zeros(BOUNDARY_SIZE)

    for i in range(BOUNDARY_SIZE):
        # Combine interior evidence for each boundary site
        gather_pattern = generate_gather(i, budget)
        boundary[i] = sum(interior[s] * w for s,w in gather_pattern)

    return quantize(boundary)
</code></pre>
<h2 id="budgets--receipts"><a class="header" href="#budgets--receipts">Budgets &amp; Receipts</a></h2>
<h3 id="the-budget-semiring"><a class="header" href="#the-budget-semiring">The Budget Semiring</a></h3>
<p><strong>Definition 3.7 (Budget Algebra)</strong>:</p>
<pre><code>C₉₆ = (ℤ₉₆, +, ×, 0, 1)
</code></pre>
<p>Budgets track semantic cost:</p>
<ul>
<li>Addition for sequential composition</li>
<li>Multiplication for parallel scaling</li>
<li>Zero means “perfectly lawful”</li>
</ul>
<p><strong>Definition 3.8 (Crush to Truth)</strong>:</p>
<pre><code>⟨β⟩ = true  iff β = 0 in ℤ₉₆
⟨β⟩ = false iff β ≠ 0 in ℤ₉₆
</code></pre>
<p>This gives us a decision procedure: lawful = zero budget.</p>
<h3 id="receipt-structure"><a class="header" href="#receipt-structure">Receipt Structure</a></h3>
<p><strong>Definition 3.9 (Complete Receipt)</strong>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Receipt {
    // R96 sector
    r96_digest: [u8; 32],      // Multiset hash of residues

    // C768 sector
    c768_cycle_count: u32,      // Which cycle we're in
    c768_phase: u16,           // Position within cycle (0-767)
    c768_fairness: FairnessMetrics,

    // Φ sector
    phi_lift_sites: BitSet,    // Which sites were lifted
    phi_proj_sites: BitSet,    // Which sites were projected
    phi_round_trip: bool,      // Did round-trip succeed?

    // Budget sector
    budget_total: i96,         // Accumulated semantic cost
    budget_breakdown: BudgetLedger,  // Detailed accounting
}
<span class="boring">}</span></code></pre></pre>
<h3 id="receipt-verification"><a class="header" href="#receipt-verification">Receipt Verification</a></h3>
<p><strong>Algorithm 3.1 (Linear Receipt Verification)</strong>:</p>
<pre><code class="language-python">def verify_receipt(config, receipt):
    # Check R96 (O(n) residue computation)
    computed_r96 = compute_r96_digest(config)
    if computed_r96 != receipt.r96_digest:
        return False

    # Check C768 (O(1) phase lookup)
    expected_phase = compute_phase(config.timestamp)
    if expected_phase != receipt.c768_phase:
        return False

    # Check Φ (O(boundary) round-trip test)
    if receipt.phi_round_trip:
        boundary = extract_boundary(config)
        interior = extract_interior(config)
        if proj_phi(lift_phi(boundary)) != boundary:
            return False

    # Check budget (O(k) for k operations)
    if receipt.budget_total != sum(receipt.budget_breakdown):
        return False

    return True
</code></pre>
<p><strong>Theorem 3.4 (Verification Complexity)</strong>:
Receipt verification is O(n) where n is the active window size.</p>
<p><em>Proof</em>: Each check requires at most one pass through the data. No searching, no exponential paths. □</p>
<h2 id="composition-of-receipts"><a class="header" href="#composition-of-receipts">Composition of Receipts</a></h2>
<h3 id="sequential-composition"><a class="header" href="#sequential-composition">Sequential Composition</a></h3>
<p>When composing operations A;B:</p>
<pre><code>receipt(A;B) = {
    r96: hash(r96_A, r96_B),
    c768: advance_phase(c768_A, duration_B),
    phi: phi_A ∧ phi_B,
    budget: budget_A + budget_B
}
</code></pre>
<h3 id="parallel-composition"><a class="header" href="#parallel-composition">Parallel Composition</a></h3>
<p>When composing operations A||B:</p>
<pre><code>receipt(A||B) = {
    r96: merge_histograms(r96_A, r96_B),
    c768: sync_phases(c768_A, c768_B),
    phi: phi_A ∧ phi_B,
    budget: max(budget_A, budget_B)  // Parallel doesn't add cost
}
</code></pre>
<h2 id="running-example-sorting-with-receipts"><a class="header" href="#running-example-sorting-with-receipts">Running Example: Sorting with Receipts</a></h2>
<p>Let’s trace receipt generation through a sorting operation:</p>
<pre><code class="language-python"># Initial configuration
data = [42, 17, 99, 3, 58]
sites = [(0,0), (0,1), (0,2), (0,3), (0,4)]

# Step 1: Compute initial receipt
r1 = {
    'r96': compute_r96(data),  # Hash of [R(42), R(17), R(99), R(3), R(58)]
    'c768_phase': 0,
    'phi': True,  # Boundary data, trivially coherent
    'budget': 0   # No operations yet
}

# Step 2: Bubble sort pass
swap(data, 0, 1)  # 42 &lt;-&gt; 17
r2 = {
    'r96': r1['r96'],  # Swapping preserves multiset!
    'c768_phase': 1,    # Advanced one step
    'phi': True,        # Still coherent
    'budget': 1         # One comparison operation
}

# ... continue sorting ...

# Final: Verify sorted
final_data = [3, 17, 42, 58, 99]
final_receipt = {
    'r96': r1['r96'],   # Same multiset of residues
    'c768_phase': 10,   # After 10 operations
    'phi': True,        # Maintained coherence
    'budget': 10        # Total comparisons
}

assert verify_receipt(final_data, final_receipt)  # Passes!
</code></pre>
<p>The receipt proves we sorted without adding or removing elements.</p>
<h2 id="exercises"><a class="header" href="#exercises">Exercises</a></h2>
<p><strong>Exercise 3.1</strong>: Prove that R96 is a homomorphism from byte sequences under concatenation to ℤ₉₆ under addition.</p>
<p><strong>Exercise 3.2</strong>: Calculate the complete C768 orbit for site (0,0). How many distinct sites are visited?</p>
<p><strong>Exercise 3.3</strong>: Design a Φ operator that achieves 2x compression at budget β=10. What’s the round-trip error?</p>
<p><strong>Exercise 3.4</strong>: Show that receipt verification catches single-bit errors with probability ≥ 1 - 1/96.</p>
<p><strong>Exercise 3.5</strong>: Implement receipt composition for a map-reduce operation. How do the budgets combine?</p>
<h2 id="implementation-notes"><a class="header" href="#implementation-notes">Implementation Notes</a></h2>
<p>Here’s a production-quality receipt builder:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct ReceiptBuilder {
    hasher: R96Hasher,
    scheduler: C768Scheduler,
    phi_tracker: PhiTracker,
    budget_ledger: BudgetLedger,
}

impl ReceiptBuilder {
    pub fn new(initial_config: &amp;Configuration) -&gt; Self {
        Self {
            hasher: R96Hasher::from_config(initial_config),
            scheduler: C768Scheduler::at_phase(0),
            phi_tracker: PhiTracker::new(),
            budget_ledger: BudgetLedger::new(),
        }
    }

    pub fn record_operation(&amp;mut self, op: &amp;Operation) {
        self.hasher.update(op.affected_bytes());
        self.scheduler.advance(op.duration());
        self.phi_tracker.track(op.phi_operations());
        self.budget_ledger.charge(op.cost());
    }

    pub fn finalize(self) -&gt; Receipt {
        Receipt {
            r96_digest: self.hasher.finalize(),
            c768_state: self.scheduler.get_state(),
            phi_coherent: self.phi_tracker.is_coherent(),
            budget: self.budget_ledger.total(),
        }
    }
}
<span class="boring">}</span></code></pre></pre>
<h2 id="takeaways"><a class="header" href="#takeaways">Takeaways</a></h2>
<ol>
<li><strong>R96 gives semantic types</strong>: 96 equivalence classes with algebraic structure</li>
<li><strong>C768 ensures perfect fairness</strong>: Every site gets equal time</li>
<li><strong>Φ preserves information</strong>: Round-trip identity at zero budget</li>
<li><strong>Budgets track lawfulness</strong>: Zero budget = perfectly lawful</li>
<li><strong>Receipts are proof-carrying data</strong>: Linear-time verification</li>
<li><strong>Composition is algebraic</strong>: Receipts compose like the operations they witness</li>
</ol>
<p>These three labeling systems—R96, C768, Φ—work together to make lawfulness intrinsic and verifiable.</p>
<hr />
<p><em>Next: Chapter 4 shows how these labels enable perfect hashing and content-addressable memory.</em></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../part-1/02-universal-automaton.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../part-1/04-content-addressable-memory.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../part-1/02-universal-automaton.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../part-1/04-content-addressable-memory.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
