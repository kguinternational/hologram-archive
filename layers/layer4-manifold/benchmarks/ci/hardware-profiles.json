{
  "version": "1.0",
  "description": "Hardware profile configurations for Layer 4 Manifold performance testing",
  "profiles": {
    "x86_64": {
      "name": "x86_64 Desktop/Server",
      "description": "High-performance x86_64 systems with modern SIMD instructions",
      "architecture": "x86_64",
      "features": {
        "simd": ["sse4.1", "sse4.2", "avx", "avx2", "fma"],
        "cache_sizes": {
          "l1_data": "32KB",
          "l1_instruction": "32KB", 
          "l2": "256KB",
          "l3": "8MB"
        },
        "memory": {
          "bandwidth_gbps": 25.6,
          "latency_ns": 100,
          "prefetch_distance": 64
        }
      },
      "compiler_flags": {
        "rust": ["-C", "target-cpu=native", "-C", "opt-level=3"],
        "c": ["-march=native", "-O3", "-ffast-math", "-funroll-loops"]
      },
      "benchmark_config": {
        "iterations": 100,
        "warmup_iterations": 10,
        "min_duration_ms": 1000,
        "max_duration_ms": 10000,
        "data_sizes": [4096, 65536, 1048576, 16777216],
        "shard_counts": [2, 4, 8, 16]
      },
      "performance_expectations": {
        "throughput_class": "high",
        "baseline_multiplier": 1.0,
        "memory_efficiency": "high",
        "conservation_overhead": "minimal"
      },
      "limits": {
        "max_memory_mb": 2048,
        "max_execution_time_sec": 300,
        "regression_threshold_percent": 10
      }
    },
    "arm64": {
      "name": "ARM64 Mobile/Edge",
      "description": "ARM64 systems with NEON/ASIMD vector processing",
      "architecture": "arm64",
      "features": {
        "simd": ["neon", "asimd", "fp16"],
        "cache_sizes": {
          "l1_data": "64KB",
          "l1_instruction": "64KB",
          "l2": "512KB",
          "l3": "4MB"
        },
        "memory": {
          "bandwidth_gbps": 17.0,
          "latency_ns": 120,
          "prefetch_distance": 32
        }
      },
      "compiler_flags": {
        "rust": ["-C", "target-cpu=native", "-C", "opt-level=3"],
        "c": ["-mcpu=native", "-O3", "-ffast-math"]
      },
      "benchmark_config": {
        "iterations": 75,
        "warmup_iterations": 8,
        "min_duration_ms": 1500,
        "max_duration_ms": 12000,
        "data_sizes": [4096, 65536, 1048576, 8388608],
        "shard_counts": [2, 4, 8]
      },
      "performance_expectations": {
        "throughput_class": "medium-high",
        "baseline_multiplier": 0.75,
        "memory_efficiency": "high",
        "conservation_overhead": "low",
        "power_efficiency": "excellent"
      },
      "limits": {
        "max_memory_mb": 1024,
        "max_execution_time_sec": 400,
        "regression_threshold_percent": 15
      },
      "emulation_config": {
        "qemu_user": true,
        "timeout_multiplier": 3.0,
        "reliability_factor": 0.7,
        "notes": "ARM64 benchmarks under x86_64 emulation are approximate"
      }
    },
    "wasm32": {
      "name": "WebAssembly",
      "description": "WebAssembly runtime with SIMD support",
      "architecture": "wasm32",
      "features": {
        "simd": ["simd128"],
        "runtime_features": ["bulk-memory", "sign-extension"],
        "memory": {
          "linear_memory": true,
          "max_pages": 4096,
          "page_size": 65536
        }
      },
      "compiler_flags": {
        "rust": ["-C", "opt-level=3", "-C", "lto=fat", "-C", "codegen-units=1"],
        "wasm_opt": ["-O3", "--enable-simd"]
      },
      "benchmark_config": {
        "iterations": 50,
        "warmup_iterations": 5,
        "min_duration_ms": 2000,
        "max_duration_ms": 15000,
        "data_sizes": [4096, 32768, 262144, 1048576],
        "shard_counts": [2, 4]
      },
      "performance_expectations": {
        "throughput_class": "medium",
        "baseline_multiplier": 0.5,
        "memory_efficiency": "medium",
        "conservation_overhead": "medium",
        "startup_overhead": "high"
      },
      "limits": {
        "max_memory_mb": 256,
        "max_execution_time_sec": 600,
        "regression_threshold_percent": 20,
        "stack_size_kb": 32
      },
      "runtime_config": {
        "engine": "wasmtime",
        "features": ["simd", "bulk-memory"],
        "memory_limit": "268435456",
        "fuel_limit": "1000000000"
      }
    },
    "x86_64_constrained": {
      "name": "x86_64 Constrained",
      "description": "Lower-end or older x86_64 systems without modern SIMD",
      "architecture": "x86_64",
      "features": {
        "simd": ["sse2"],
        "cache_sizes": {
          "l1_data": "32KB",
          "l1_instruction": "32KB",
          "l2": "256KB",
          "l3": "2MB"
        },
        "memory": {
          "bandwidth_gbps": 12.8,
          "latency_ns": 150,
          "prefetch_distance": 32
        }
      },
      "compiler_flags": {
        "rust": ["-C", "target-cpu=x86-64", "-C", "opt-level=3"],
        "c": ["-march=x86-64", "-O3"]
      },
      "benchmark_config": {
        "iterations": 50,
        "warmup_iterations": 5,
        "min_duration_ms": 2000,
        "max_duration_ms": 15000,
        "data_sizes": [4096, 32768, 524288, 4194304],
        "shard_counts": [2, 4]
      },
      "performance_expectations": {
        "throughput_class": "medium-low",
        "baseline_multiplier": 0.4,
        "memory_efficiency": "medium",
        "conservation_overhead": "medium"
      },
      "limits": {
        "max_memory_mb": 512,
        "max_execution_time_sec": 450,
        "regression_threshold_percent": 25
      }
    }
  },
  "test_matrices": {
    "universal_number_operations": {
      "description": "Core UN operations that should work across all platforms",
      "operations": [
        "linear_projection",
        "r96_fourier",
        "shard_extraction",
        "transformation",
        "invariant_computation",
        "conservation_verification"
      ],
      "required_for_all_profiles": true
    },
    "advanced_operations": {
      "description": "Complex operations that may have limited support on constrained platforms",
      "operations": [
        "batch_shard_extraction",
        "reconstruction",
        "parallel_projection",
        "streaming_transformation"
      ],
      "required_profiles": ["x86_64", "arm64"],
      "optional_profiles": ["wasm32", "x86_64_constrained"]
    },
    "memory_intensive": {
      "description": "Operations that test memory bandwidth and large data handling",
      "operations": [
        "large_dataset_projection",
        "multi_shard_reconstruction",
        "memory_mapped_processing"
      ],
      "required_profiles": ["x86_64"],
      "excluded_profiles": ["wasm32"]
    }
  },
  "platform_adaptations": {
    "memory_scaling": {
      "description": "Adjust data sizes based on platform memory limits",
      "rules": [
        {
          "condition": "profile.limits.max_memory_mb < 512",
          "action": "scale_data_sizes",
          "factor": 0.5
        },
        {
          "condition": "profile.architecture == 'wasm32'",
          "action": "limit_concurrent_operations",
          "max_concurrent": 1
        }
      ]
    },
    "timeout_scaling": {
      "description": "Adjust timeouts based on expected performance",
      "rules": [
        {
          "condition": "profile.emulation_config.timeout_multiplier > 1",
          "action": "multiply_timeouts",
          "factor": "profile.emulation_config.timeout_multiplier"
        },
        {
          "condition": "profile.performance_expectations.baseline_multiplier < 0.5",
          "action": "extend_timeouts",
          "factor": 2.0
        }
      ]
    },
    "feature_selection": {
      "description": "Enable/disable features based on platform capabilities",
      "rules": [
        {
          "condition": "profile.architecture == 'wasm32'",
          "action": "disable_features",
          "features": ["parallel", "streaming", "compression"]
        },
        {
          "condition": "'avx2' in profile.features.simd",
          "action": "enable_features", 
          "features": ["simd_optimization", "vectorized_conservation"]
        }
      ]
    }
  },
  "ci_integration": {
    "github_actions": {
      "runner_mapping": {
        "x86_64": "ubuntu-latest",
        "arm64": "ubuntu-latest",
        "wasm32": "ubuntu-latest",
        "x86_64_constrained": "ubuntu-20.04"
      },
      "parallel_execution": true,
      "failure_handling": {
        "allow_arm64_failure": true,
        "allow_wasm32_failure": false,
        "retry_count": 2
      }
    },
    "reporting": {
      "include_in_pr_comment": ["x86_64", "arm64", "wasm32"],
      "detailed_reporting": ["x86_64"],
      "summary_only": ["arm64", "wasm32", "x86_64_constrained"]
    }
  }
}