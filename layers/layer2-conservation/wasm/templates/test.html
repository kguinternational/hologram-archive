<!DOCTYPE html>
<html>
<head>
    <title>Atlas Conservation WASM Tests</title>
    <style>
        body { font-family: monospace; margin: 20px; }
        #output { background: #f0f0f0; padding: 10px; white-space: pre; }
        button { padding: 10px; margin: 5px; }
    </style>
</head>
<body>
    <h1>Atlas Conservation Layer WASM Tests</h1>
    <button onclick="runTests()">Run Tests</button>
    <div id="output"></div>
    
    <script>
        let Module = {};
        let outputDiv = document.getElementById('output');
        
        Module.print = function(text) {
            outputDiv.textContent += text + '\n';
            console.log(text);
        };
        
        Module.printErr = function(text) {
            outputDiv.textContent += 'ERROR: ' + text + '\n';
            console.error(text);
        };
        
        function runTests() {
            outputDiv.textContent = 'Loading WASM module...\n';
            
            // Load and run the test module
            import('./test-conservation.js').then(({ default: TestModule }) => {
                TestModule(Module).then(function(instance) {
                    outputDiv.textContent += 'Running conservation tests...\n';
                    try {
                        let result = instance._main();
                        outputDiv.textContent += '\nTest completed with exit code: ' + result + '\n';
                    } catch (e) {
                        outputDiv.textContent += 'Test execution failed: ' + e + '\n';
                    }
                });
            }).catch(function(error) {
                outputDiv.textContent += 'Failed to load WASM module: ' + error + '\n';
            });
        }
    </script>
</body>
</html>